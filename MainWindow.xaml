<Window x:Class="DotNetPad32.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:DotNetPad32" mc:Ignorable="d" 
        xmlns:controls="clr-namespace:DotNetPad32"
        Closing="AppWindow_Closing" Name="AppWindow" Background="Transparent" Title="MainWindow" Height="700" Width="1024">
    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <RoutedUICommand x:Key="FindNextCommand" Text="FindNext">
            <RoutedUICommand.InputGestures>
                <KeyGesture>F3</KeyGesture>
            </RoutedUICommand.InputGestures>
        </RoutedUICommand>
        <RoutedUICommand x:Key="FindPreviousCommand" Text="FindPrevious">
            <RoutedUICommand.InputGestures>
                <KeyGesture>Shift+F3</KeyGesture>
            </RoutedUICommand.InputGestures>
        </RoutedUICommand>
        <RoutedUICommand x:Key="ReplaceCommand" Text="Replace">
            <RoutedUICommand.InputGestures>
                <KeyGesture>Ctrl+H</KeyGesture>
            </RoutedUICommand.InputGestures>
        </RoutedUICommand>
        <RoutedUICommand x:Key="ReplaceAllCommand" Text="ReplaceAll">
            <RoutedUICommand.InputGestures>
                <KeyGesture>Ctrl+Shift+H</KeyGesture>
            </RoutedUICommand.InputGestures>
        </RoutedUICommand>
        <RoutedUICommand x:Key="GoToCommand" Text="GoTo">
            <RoutedUICommand.InputGestures>
                <KeyGesture>Ctrl+G</KeyGesture>
            </RoutedUICommand.InputGestures>
        </RoutedUICommand>
        <RoutedUICommand x:Key="TimeDateCommand" Text="TimeDate">
            <RoutedUICommand.InputGestures>
                <KeyGesture>F5</KeyGesture>
            </RoutedUICommand.InputGestures>
        </RoutedUICommand>
    </Window.Resources>
    <Window.CommandBindings>
        <CommandBinding Command="New" Executed="NewCommandBinding_Executed" />
        <CommandBinding Command="Open" Executed="OpenCommandBinding_Executed" />
        <CommandBinding Command="Save" Executed="SaveCommandBinding_Executed" />
        <CommandBinding Command="SaveAs" Executed="SaveAsCommandBinding_Executed" />
        <CommandBinding Command="Close" Executed="CloseCommandBinding_Executed" />
        <CommandBinding Command="Print" Executed="PrintCommandBinding_Executed" />
        <CommandBinding Command="Delete" Executed="DeleteCommandBinding_Executed" />
        <CommandBinding Command="Find" Executed="FindCommandBinding_Executed" />
        <CommandBinding Command="{StaticResource FindNextCommand}" Executed="FindNextCommandBinding_Executed" />
        <CommandBinding Command="{StaticResource FindPreviousCommand}" Executed="FindPreviousCommandBinding_Executed"/>
        <CommandBinding Command="{StaticResource ReplaceCommand}" Executed="ReplaceCommandBinding_Executed"/>
        <CommandBinding Command="{StaticResource ReplaceAllCommand}" Executed="ReplaceAllCommandBinding_Executed"/>
        <CommandBinding Command="{StaticResource GoToCommand}" Executed="GoToCommandBinding_Executed"/>
        <CommandBinding Command="{StaticResource TimeDateCommand}" Executed="TimeDateCommandBinding_Executed"/>
        <CommandBinding Command="NavigationCommands.Zoom" Executed="ZoomCommandBinding_Executed" />
    </Window.CommandBindings>
    <Window.InputBindings>
        <KeyBinding Gesture="Ctrl + N" Command="New" />
        <KeyBinding Key="S" Modifiers="Ctrl + Shift" Command="SaveAs" />
        <KeyBinding Key="W" Modifiers="Ctrl" Command="Close" />
        <KeyBinding Key="OemPlus" Modifiers="Ctrl" Command="NavigationCommands.Zoom" CommandParameter="In" />
        <KeyBinding Key="OemMinus" Modifiers="Ctrl" Command="NavigationCommands.Zoom" CommandParameter="Out" />
        <KeyBinding Key="D0" Modifiers="Ctrl" Command="NavigationCommands.Zoom" CommandParameter="Restore" />
    </Window.InputBindings>
    <Grid Name="OuterGrid">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="0" />
        </Grid.ColumnDefinitions>
        <Grid Grid.Column="0" Name="AppGrid" Background="Transparent">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid Grid.Row="0" Name="MenuGrid" Background="Transparent">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Menu Grid.Column="0" FlowDirection="LeftToRight" HorizontalAlignment="Left" VerticalAlignment="Top" HorizontalContentAlignment="Left" BorderThickness="0" Padding="0,-2,0,0" Margin="0,0,0,0">
                    <MenuItem Header="_File" HorizontalAlignment="Left" WindowChrome.IsHitTestVisibleInChrome="False">
                        <MenuItem Name="NewMenu" Command="New" Header="_New">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Name="NewWindowMenu" Command="{Binding NewWindowCommand}" Header="New _window" InputGestureText="Ctrl+Shift+N" >
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Name="OpenMenu" Command="Open" Header="_Open...">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Name="RecentMenu" Header="_Recent">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                            <Separator Name="RecentSeparator" />
                            <MenuItem Name="ClearListMenu" Header="Clear list" />
                        </MenuItem>
                        <MenuItem Name="SaveMenu" Command="Save" Header="_Save">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Name="SaveAsMenu" Command="SaveAs" Header="Save _as..." InputGestureText="Ctrl+Shift+S" IsChecked="False">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Name="AutoSaveMenu" Header="Auto sa_ve" IsCheckable="True" IsChecked="False" Click="AutoSaveMenu_Click" />
                        <Separator />
                        <MenuItem Name="PrintMenu" Command="Print" Header="_Print">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator />
                        <MenuItem Name="ExitMenu" Command="Close" Header="E_xit" InputGestureText="Alt+F4">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                        </MenuItem>
                    </MenuItem>
                    <MenuItem Header="_Edit" HorizontalAlignment="Left" WindowChrome.IsHitTestVisibleInChrome="False">
                        <MenuItem Name="UndoMenu" Command="Undo" Header="_Undo" />
                        <Separator />
                        <MenuItem Name="CutMenu" Command="Cut" Header="Cu_t" />
                        <MenuItem Name="CopyMenu" Command="Copy" Header="_Copy" />
                        <MenuItem Name="PasteMenu" Command="Paste" Header="_Paste" />
                        <MenuItem Name="DeleteMenu" Command="Delete" Header="De_lete" />
                        <Separator />
                        <MenuItem Name="FindMenu" Command="Find" Header="_Find" />
                        <MenuItem Name="FindNextMenu" Command="{StaticResource FindNextCommand}" Header="Find _next" />
                        <MenuItem Name="FindPreviousMenu" Command="{StaticResource FindPreviousCommand}" Header="Find pre_vious" />
                        <MenuItem Name="ReplaceMenu" Command="{StaticResource ReplaceCommand}" Header="_Replace" />
                        <MenuItem Name="ReplaceAllMenu" Command="{StaticResource ReplaceAllCommand}" Header="Replace a_ll" />
                        <MenuItem Name="GoToMenu" Command="{StaticResource GoToCommand}" Header="_Go to" />
                        <Separator />
                        <MenuItem Name="SelectAllMenu" Command="SelectAll" Header="Select _all" />
                        <MenuItem Name="TimeDateMenu" Command="{StaticResource TimeDateCommand}" Header="Time/_Date" InputGestureText="F5" />
                        <Separator />
                        <MenuItem Name="FontMenu" Header="_Font" Click="FontMenu_Click" />
                    </MenuItem>
                    <MenuItem Header="_View" HorizontalAlignment="Left" WindowChrome.IsHitTestVisibleInChrome="False">
                        <MenuItem Header="_Zoom">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                            <MenuItem Command="NavigationCommands.Zoom" CommandParameter="In" Name="ZoomInMenu" Header="Zoom _in" InputGestureText="Ctrl+Plus" />
                            <MenuItem Command="NavigationCommands.Zoom" CommandParameter="Out" Name="ZoomOutMenu" Header="Zoom _out" InputGestureText="Ctrl+Minus" />
                            <MenuItem Command="NavigationCommands.Zoom" CommandParameter="Restore" Name="RestoreDefaultZoomMenu" Header="_Restore default zoom" InputGestureText="Ctrl+0" />
                        </MenuItem>
                        <MenuItem Name="StatusBarMenu" Header="_Status bar" IsCheckable="True" Click="StatusBarMenu_Click" />
                        <MenuItem Name="WordWrapMenu" Header="_Word wrap" IsCheckable="True" IsChecked="False" Click="WordWrapMenu_Click" />
                    </MenuItem>
                </Menu>
                <Separator Grid.Column="1" Visibility="Visible" BorderThickness="0"/>
                <TextBlock Grid.Column="2" Name="NeedsToBeSavedTextBlock" Visibility="{Binding d.TextHasChanged, Converter={StaticResource BooleanToVisibilityConverter}}" FontFamily="Segoe Fluent Icons" Foreground="Red" Text="&#xE915;" Focusable="False" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,3,0,0" />
                <Menu Grid.Column="3" BorderThickness="0">
                    <MenuItem Name="SettingsButton" WindowChrome.IsHitTestVisibleInChrome="False" HorizontalAlignment="Right" FlowDirection="RightToLeft" ToolTip="Settings" ToolTipService.InitialShowDelay="500" Click="SettingsButton_Click">
                        <MenuItem.Header>
                            <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xE713;" />
                        </MenuItem.Header>
                    </MenuItem>
                </Menu>
            </Grid>
            <controls:FindReplace Grid.Row="1" x:Name="FindReplacePanel" Margin="0,0,0,0" Visibility="Collapsed" HorizontalAlignment="Stretch" VerticalAlignment="Center" />
            <TextBox Grid.Row="2" Name="TextBox1" AllowDrop="True" AcceptsReturn="True" TextWrapping="NoWrap" BorderThickness="0" SpellCheck.IsEnabled="False" Style="{StaticResource Win11TextBox}" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" TextChanged="TextBox1_TextChanged" GotMouseCapture="TextBox1_GotMouseCapture" KeyUp="TextBox1_KeyUp">
                <TextBox.ContextMenu>
                    <ContextMenu FontFamily="Segoe UI" FontSize="16">
                        <MenuItem Command="ApplicationCommands.Undo">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xE7A7;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Command="ApplicationCommands.Copy">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xe8c8;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Command="ApplicationCommands.Cut">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xe8c6;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Command="ApplicationCommands.Paste">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xE77F;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Command="ApplicationCommands.Delete">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xE74D;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Command="ApplicationCommands.SelectAll">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xe8b3;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="Define with Bing">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xf6fa;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="Rewrite">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xee56;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Custom rewrite">
                            <MenuItem.Icon>
                                <Image Source="/empty.png" Width="20" />
                            </MenuItem.Icon>
                            <MenuItem Header="Make shorter" />
                                <MenuItem Header="Make longer" />
                                <MenuItem Header="Change tone" />
                                <MenuItem Header="Change format" />
                            </MenuItem>
                        <MenuItem Header="Summarize">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xf4a5;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator/>
                        <MenuItem Header="Spelling">
                            <MenuItem.Icon>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xf87b;"/>
                            </MenuItem.Icon>
                        </MenuItem>
                    </ContextMenu>
                </TextBox.ContextMenu>
            </TextBox>
            <StatusBar Grid.Row="3" Name="StatusBar1" Padding="4" Background="Transparent">
                <StatusBarItem>
                    <ScrollViewer Focusable="False" IsTabStop="False" VerticalScrollBarVisibility="Disabled" HorizontalScrollBarVisibility="Disabled" MouseDoubleClick="AutoSaveMenu_Click">
                        <TextBlock Width="100" Name="AutoSaveText" Text="Auto save: Off" Margin="5,0,10,0" ToolTip="Double-click to toggle Auto save" ToolTipService.InitialShowDelay="500" />
                    </ScrollViewer>
                </StatusBarItem>
                <StatusBarItem>
                    <TextBlock Width="100" Name="PositionText" Text="Ln 1, Col 1" Margin="5,0,10,0"/>
                </StatusBarItem>
                <StatusBarItem>
                    <TextBlock Width="75" Name="ZoomText" Text="100%" Margin="5,0,10,0" ToolTip="Ctrl + Plus to Zoom in, Ctrl + Minus to Zoom out, Ctrl + 0 to reset" ToolTipService.InitialShowDelay="500" />
                </StatusBarItem>
                <StatusBarItem>
                    <ScrollViewer Focusable="False" IsTabStop="False" VerticalScrollBarVisibility="Disabled" HorizontalScrollBarVisibility="Disabled" MouseDoubleClick="StatusBarCount_MouseDoubleClick">
                        <TextBlock Width="100" Name="WordCountText" Text="0 characters" Margin="5,0,10,0" ToolTip="Double-click to toggle word/character count" ToolTipService.InitialShowDelay="500" />
                    </ScrollViewer>
                </StatusBarItem>
                <StatusBarItem>
                    <TextBlock Text="" />
                </StatusBarItem>
            </StatusBar>
        </Grid>
        <ScrollViewer Grid.Column="1" Name="SettingsScrollViewer" Focusable="False" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" >
            <Grid Name="SettingsGrid" Visibility="Collapsed">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>
                <Grid Grid.Row="0" Grid.ColumnSpan="2" Name="SettingsHeaderGrid" HorizontalAlignment="Stretch">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Settings" Style="{StaticResource TitleLargeTextBlockStyle}" Margin="50,40,0,10" HorizontalAlignment="Left" VerticalAlignment="Top" />
                    <Menu Grid.Row="0" Grid.Column="1" BorderThickness="0" HorizontalAlignment="Right" VerticalAlignment="Top">
                        <MenuItem Name="BackButton" WindowChrome.IsHitTestVisibleInChrome="False" HorizontalAlignment="Right" FlowDirection="RightToLeft" ToolTip="Exit settings" ToolTipService.InitialShowDelay="500" Click="BackButton_Click">
                            <MenuItem.Header>
                                <TextBlock FontFamily="Segoe Fluent Icons" Text="&#xE72B;" />
                            </MenuItem.Header>
                        </MenuItem>
                    </Menu>
                </Grid>
                <Grid Name="MainSetingsGrid" Grid.Row="1" Grid.Column="0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <Label Grid.Row="1" Content="Appearance" Style="{StaticResource Win11Text}" Margin="50,10,20,10" HorizontalAlignment="Left" VerticalAlignment="Top" />
                    <Expander Grid.Row="2" Name="AppThemeExpander" Margin="50,0,50,0" IsExpanded="False" Focusable="False">
                        <Expander.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0" Style="{StaticResource Win11Text}" FontFamily="Segoe Fluent Icons" FontSize="16" Content="&#xE790;" Margin="10,10,10,10" />
                                <Grid Grid.Column="1" Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Label Grid.Row="0" Content="App theme" Style="{StaticResource Win11Text}" />
                                    <Label Grid.Row="1" Content="Select which app theme to display" Padding="5,0,0,0" Style="{StaticResource Win11Text2}" />
                                </Grid>
                            </Grid>
                        </Expander.Header>
                        <Expander.Content>
                            <StackPanel>
                                <RadioButton Content="Light" Name="LightThemeRadio" GroupName="ThemeGroup" IsChecked="False" FontFamily="Segoe UI Variable" FontSize="14" Margin="60,0,0,0" Click="LightThemeRadio_Click" />
                                <RadioButton Content="Dark" Name="DarkThemeRadio" GroupName="ThemeGroup" IsChecked="False" FontFamily="Segoe UI Variable" FontSize="14" Margin="60,5,0,0" Click="DarkThemeRadio_Click" />
                                <RadioButton Content="Use system setting" Name="SystemThemeRadio" GroupName="ThemeGroup" IsChecked="True" FontFamily="Segoe UI Variable" FontSize="14" Margin="60,5,0,0" Click="SystemThemeRadio_Click" />
                            </StackPanel>
                        </Expander.Content>
                    </Expander>
                    <Label Grid.Row="3" Content="Text Formatting" Style="{StaticResource Win11Text}" Margin="50,10,20,10" HorizontalAlignment="Left" VerticalAlignment="Top" />
                    <Expander Grid.Row="4" Name="FontExpander" Margin="50,0,50,5" IsExpanded="False" Focusable="False">
                        <Expander.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0" Style="{StaticResource Win11Text}" FontFamily="Segoe Fluent Icons" FontSize="16" Content="&#xE8D2;" Margin="10,10,10,10" />
                                <Grid Grid.Column="1" Margin="10,0,0,0">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                    </Grid.RowDefinitions>
                                    <Label Grid.Row="0" Style="{StaticResource Win11Text}" Content="Font" VerticalAlignment="Center" />
                                </Grid>
                            </Grid>
                        </Expander.Header>
                        <Expander.Content>
                            <StackPanel>
                                <Border BorderThickness="0,0,0,1" BorderBrush="{DynamicResource ControlAltFillColorQuarternaryBrush}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Content="Family" Style="{StaticResource Win11Text}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="50,5,0,5" />
                                        <ComboBox Name="FontFamilyComboBox" Grid.Column="1" MinWidth="225" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,5,50,5" SelectedIndex="0" IsEditable="False" IsReadOnly="True" ItemsSource="{x:Static Fonts.SystemFontFamilies}" Padding="10,5,5,5" SelectionChanged="FontFamilyComboBox_SelectionChanged" />
                                    </Grid>
                                </Border>
                                <Border BorderThickness="0,0,0,1" BorderBrush="{DynamicResource ControlAltFillColorQuarternaryBrush}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Content="Style" Style="{StaticResource Win11Text}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="50,5,0,5" />
                                        <ComboBox Name="FontStyleComboBox" Grid.Column="1" MinWidth="225" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,5,50,5" SelectedIndex="0" IsEditable="False" IsReadOnly="True" ItemsSource="{Binding}" Padding="10,5,5,5" SelectionChanged="FontStyleComboBox_SelectionChanged" />
                                    </Grid>
                                </Border>
                                <Border BorderThickness="0,0,0,1" BorderBrush="{DynamicResource ControlAltFillColorQuarternaryBrush}">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="Auto" />
                                        </Grid.ColumnDefinitions>
                                        <Label Grid.Column="0" Content="Size" Style="{StaticResource Win11Text}" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="50,5,0,5" />
                                        <ComboBox Name="FontSizeComboBox" Grid.Column="1" MinWidth="225" HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,5,50,5" SelectedIndex="0" IsEditable="False" IsReadOnly="True" ItemsSource="{Binding}" Padding="10,5,5,5" SelectionChanged="FontSizeComboBox_SelectionChanged" />
                                    </Grid>
                                </Border>
                                <Label Name="FontExampleLabel" Content="The sound of ocean waves calms my soul" Style="{StaticResource Win11Text}" HorizontalAlignment="Center" VerticalAlignment="Center" Height="Auto" BorderThickness="0" Background="Transparent" Margin="0,30,0,20" />
                            </StackPanel>
                        </Expander.Content>
                    </Expander>
                    <Border Grid.Row="5" Height="70" Margin="50,0,50,0" CornerRadius="4"  Background="{DynamicResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{DynamicResource ControlAltFillColorTertiaryBrush}" BorderThickness="1">
                        <StackPanel Focusable="False">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0" HorizontalAlignment="Left" Width="32" Style="{StaticResource Win11Text}" FontFamily="Segoe Fluent Icons" FontSize="16" Content="&#xE7BC;" Margin="20,20,10,10" VerticalAlignment="Top" />
                                <Grid Grid.Column="1" Margin="10,7,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="1*" />
                                        <RowDefinition Height="1*" />
                                    </Grid.RowDefinitions>
                                    <Label Grid.Row="0" Padding="0" Content="Word wrap" Style="{StaticResource Win11Text}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,5,0,0" />
                                    <Label Grid.Row="1" Padding="0" Content="Fit text within window by default" Style="{StaticResource Win11Text2}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,5,0,0" />
                                </Grid>
                                <ToggleButton Grid.Column="2" Content="Off" Name="WordWrapToggleButton" Margin="10,17,10,0" IsChecked="False" HorizontalAlignment="Left" VerticalAlignment="Top" Click="WordWrapMenu_Click" />
                            </Grid>
                        </StackPanel>
                    </Border>
                    <!-- Add session state UI here -->
                    <Label Grid.Row="8" Content="Files" Style="{StaticResource Win11Text}" Margin="50,10,20,10" HorizontalAlignment="Left" VerticalAlignment="Top" />
                    <Border Grid.Row="9" Visibility="Collapsed" Height="70" Margin="50,0,50,0" CornerRadius="4"  Background="{DynamicResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{DynamicResource ControlAltFillColorTertiaryBrush}" BorderThickness="1">
                        <StackPanel Focusable="False">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0" HorizontalAlignment="Left" Width="32" Style="{StaticResource Win11Text}" FontFamily="Segoe Fluent Icons" FontSize="16" Content="&#xE8E5;" Margin="20,20,10,10" VerticalAlignment="Top" />
                                <Grid Grid.Column="1" Margin="10,7,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="1*" />
                                        <RowDefinition Height="1*" />
                                    </Grid.RowDefinitions>
                                    <Label Grid.Row="0" Padding="0" Content="Opening files" Style="{StaticResource Win11Text}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,5,0,0" />
                                    <Label Grid.Column="1" Margin="10,10,0,0" Padding="0" Content="Spell check" Style="{StaticResource Win11Text}" VerticalAlignment="Center" HorizontalAlignment="Left" />
                                </Grid>
                                <ComboBox Grid.Column="2" Margin="10,17,10,0" Padding="10,5,5,5" HorizontalAlignment="Right" VerticalAlignment="Top" SelectedIndex="0" IsEditable="False" IsReadOnly="True">
                                    <ComboBoxItem Content="Open in a new tab" />
                                    <ComboBoxItem Content="Open in a new window" />
                                </ComboBox>
                            </Grid>
                        </StackPanel>
                    </Border>
                    <Border Grid.Row="10" Height="70" Margin="50,0,50,0" CornerRadius="4"  Background="{DynamicResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{DynamicResource ControlAltFillColorTertiaryBrush}" BorderThickness="1">
                        <StackPanel Focusable="False">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0" HorizontalAlignment="Left" Width="32" Style="{StaticResource Win11Text}" FontFamily="Segoe Fluent Icons" FontSize="16" Content="&#xE78C;" Margin="20,20,10,10" VerticalAlignment="Top" />
                                <Grid Grid.Column="1" Margin="10,7,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="1*" />
                                        <RowDefinition Height="1*" />
                                    </Grid.RowDefinitions>
                                    <Label Grid.Row="0" Padding="0" Content="Auto save" Style="{StaticResource Win11Text}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,5,0,0" />
                                    <Label Grid.Row="1" Padding="0" Content="Automatically save your document every 30 seconds" Style="{StaticResource Win11Text2}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,5,0,0" />
                                </Grid>
                                <ToggleButton Grid.Column="2" Content="Off" Name="AutoSaveToggleButton" Margin="10,17,10,0" IsChecked="False" HorizontalAlignment="Left" VerticalAlignment="Top" Click="AutoSaveMenu_Click"  />
                            </Grid>
                        </StackPanel>
                    </Border>
                    <Label Grid.Row="11" Content="Spelling" Style="{StaticResource Win11Text}" Margin="50,10,20,10" HorizontalAlignment="Left" VerticalAlignment="Top" />
                    <Border Grid.Row="12" Height="70" Margin="50,0,50,0" CornerRadius="4"  Background="{DynamicResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{DynamicResource ControlAltFillColorTertiaryBrush}" BorderThickness="1">
                        <StackPanel Focusable="False">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0" HorizontalAlignment="Left" Width="32" Style="{StaticResource Win11Text}" FontFamily="Segoe Fluent Icons" FontSize="16" Content="&#xF87B;" Margin="20,20,10,10" VerticalAlignment="Top" />
                                <Label Grid.Column="1" Margin="10,10,0,0" Padding="0" Content="Spell check" Style="{StaticResource Win11Text}" VerticalAlignment="Center" HorizontalAlignment="Left" />
                                <ToggleButton Grid.Column="2" Name="SpellCheckToggleButton" Content="Off" Margin="10,17,10,0" IsChecked="False" HorizontalAlignment="Left" VerticalAlignment="Top" Click="SpellCheckToggleButton_Click" />
                            </Grid>
                        </StackPanel>
                    </Border>
                    <Border Grid.Row="13" Visibility="Collapsed" Height="70" Margin="50,5,50,0" CornerRadius="4"  Background="{DynamicResource CardBackgroundFillColorDefaultBrush}" BorderBrush="{DynamicResource ControlAltFillColorTertiaryBrush}" BorderThickness="1">
                        <StackPanel Focusable="False">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <Label Grid.Column="0" HorizontalAlignment="Left" Width="32" Style="{StaticResource Win11Text}" FontFamily="Segoe Fluent Icons" FontSize="16" Content="&#xE70F;" Margin="20,20,10,10" VerticalAlignment="Top" />
                                <Grid Grid.Column="1" Margin="10,7,0,0" HorizontalAlignment="Left" VerticalAlignment="Top">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="1*" />
                                        <RowDefinition Height="1*" />
                                    </Grid.RowDefinitions>
                                    <Label Grid.Row="0" Padding="0" Content="Autocorrect" Style="{StaticResource Win11Text}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,5,0,0" />
                                    <Label Grid.Row="1" Padding="0" Content="Typos are automatically corrected when spell check is turned on" Style="{StaticResource Win11Text2}" VerticalAlignment="Center" HorizontalAlignment="Left" Margin="0,5,0,0" />
                                </Grid>
                                <ToggleButton Grid.Column="2" Name="AutocorrectButton" Content="On" Margin="10,17,10,0" IsChecked="False" HorizontalAlignment="Left" VerticalAlignment="Top" />
                            </Grid>
                        </StackPanel>
                    </Border>
                </Grid>
                <Grid Name="AboutGrid" Grid.Row="1" Grid.Column="1" Width="300" HorizontalAlignment="Left">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="50" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="Auto" />
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Grid.ColumnSpan="2" Text="About this app" Style="{StaticResource SubtitleTextBlockStyle}" />
                    <Image Source="/t-pride-icon.png" Grid.Row="1" Grid.Column="0" Grid.RowSpan="3" Width="40" Height="40" HorizontalAlignment="Left" VerticalAlignment="Center" />
                    <Label Name="AppNameLabel" Grid.Row="1" Grid.Column="1" Content="App name" Style="{StaticResource Win11Text}" />
                    <Label Name="VersionLabel" Grid.Row="2" Grid.Column="1" Content="Version number" Style="{StaticResource Win11Text}" />
                    <Label Name="CopyrightLabel" Grid.Row="3" Grid.Column="1" Content="Copyright" Style="{StaticResource Win11Text}" />
                    <Button Name="ResetButton" Grid.Row="4" Grid.ColumnSpan="2" Content="Reset settings" Margin="0,5,0,0" Click="ResetButton_Click" />
                </Grid>
                <Grid Name="SettingsSpacerGrid" Grid.Column="0" Grid.Row="2" Height="50" />
            </Grid>
        </ScrollViewer>
    </Grid>
</Window>
